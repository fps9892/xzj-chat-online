<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Sala General - ChatUp</title>
    <link rel="icon" type="image/svg+xml" href="/images/logo.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/base.css" />
    <link rel="stylesheet" href="/emotes.css" />
    <link rel="stylesheet" href="/rooms-management.css" />
    <link rel="stylesheet" href="/join-notifications.css" />
    <link rel="stylesheet" href="/refresh-button.css" />
    <link rel="stylesheet" href="/games-panel.css" />
    <link rel="stylesheet" href="/developer-panel.css" />
    <link rel="stylesheet" href="/resolutions/mobile.css" />
    <link rel="stylesheet" href="/resolutions/tablet.css" />
    <link rel="stylesheet" href="/resolutions/desktop.css" />
    <link rel="stylesheet" href="/level-system.css" />
    <link rel="stylesheet" href="/message-options.css" />
    <!-- VerificaciÃ³n de autenticaciÃ³n ANTES de cargar el body -->
    <!-- <script src="/auth-check.js"></script> -->
  </head>
  <body>
    <!-- Pantalla de Usuario Baneado -->
    <div class="banned-overlay" id="bannedOverlay" style="display: none">
      <div class="banned-content">
        <h1>â›” BANEADO</h1>
        <p>Tu cuenta ha sido suspendida</p>
        <div class="ban-reason">
          <strong>RazÃ³n:</strong>
          <span id="ban-reason-text">No especificada</span>
        </div>
        <p id="ban-duration"></p>
        <p>Si crees que esto es un error, contacta a un administrador</p>
      </div>
    </div>

    <!-- Pantalla de Carga Profesional -->
    <div class="loading-screen" id="loadingScreen">
      <canvas id="loading-particles"></canvas>
      <div class="loading-content">
        <div class="loading-logo-container">
          <img src="/images/logo.svg" alt="Logo" class="loading-logo-svg" />
        </div>
        <div class="loading-text">ChatUp</div>
        <div class="loading-progress">
          <div class="progress-bar"></div>
        </div>
      </div>
    </div>
    <header class="header">
      <div class="user-info">
        <img
          src="/images/profileuser.svg"
          alt="Profile"
          class="profile-image"
        />
        <span class="username desktop-only">username</span>
      </div>

      <div class="room-selector">
        <button class="rooms-btn" id="roomsBtn">
          <img
            src="/images/rooms-public-icon.svg"
            alt="Rooms"
            class="rooms-icon"
          />
          <span class="desktop-only">Salas</span>
        </button>
      </div>

      <div class="mobile-users-indicator">
        <img
          src="/images/users-connected.svg"
          alt="Users"
          class="users-connected-icon"
        />
        <span class="mobile-user-count">0</span>
        <div class="mobile-users-dropdown">
          <!-- Los usuarios se cargarÃ¡n dinÃ¡micamente -->
        </div>
      </div>
    </header>

    <div class="main-content">
      <div class="room-header">
        <span class="current-room-name">Sala General</span>
        <span class="room-user-count">(0 usuarios)</span>
        <button class="refresh-btn" id="refreshBtn">
          <img src="/images/refresh.svg" alt="Refresh" />
        </button>
      </div>
      <div class="join-leave-notifications" id="joinLeaveNotifications"></div>
      <main class="chat-area"></main>

      <aside class="users-sidebar">
        <div class="users-header">
          <h3>Conectados <span class="user-count">0</span></h3>
        </div>
        <div class="users-list">
          <div class="skeleton-user">
            <div class="skeleton skeleton-user-avatar"></div>
            <div class="skeleton skeleton-user-name"></div>
          </div>
          <div class="skeleton-user">
            <div class="skeleton skeleton-user-avatar"></div>
            <div class="skeleton skeleton-user-name"></div>
          </div>
          <div class="skeleton-user">
            <div class="skeleton skeleton-user-avatar"></div>
            <div class="skeleton skeleton-user-name"></div>
          </div>
          <div class="skeleton-user">
            <div class="skeleton skeleton-user-avatar"></div>
            <div class="skeleton skeleton-user-name"></div>
          </div>
        </div>
        <div class="sidebar-typing-indicator" style="display: none"></div>
      </aside>
    </div>

    <div class="typing-indicator" style="display: none">
      usuario estÃ¡ escribiendo...
    </div>
    <footer class="input-area">
      <div class="input-container">
        <input
          type="text"
          class="message-input"
          placeholder="Escribe tu mensaje..."
          maxlength="250"
        />
        <span class="char-counter">0/250</span>
        <img src="/images/send.svg" alt="Send" class="send-icon" />
      </div>
    </footer>

    <!-- Controles flotantes independientes -->
    <div class="chat-controls">
      <input
        type="file"
        accept="image/*"
        class="image-input"
        style="display: none"
      />
      <input
        type="file"
        accept="audio/*"
        class="audio-input"
        style="display: none"
      />
      <img
        src="/images/image-load.svg"
        alt="Upload Image"
        class="image-btn"
        title="Enviar imagen"
      />
      <img
        src="/images/encuestas.svg"
        alt="Polls"
        class="polls-btn"
        title="Encuestas"
      />
      <img
        src="/images/microphone.svg"
        alt="Voice Message"
        class="mic-btn"
        title="Mensaje de voz"
      />
      <img
        src="/images/emote.svg"
        alt="Emotes"
        class="emote-btn"
        title="Emotes"
      />
      <div class="emote-panel">
        <div class="emote-tabs">
          <div class="emote-tab active" data-tab="emotes">Emotes</div>
          <div class="emote-tab" data-tab="gifs">GIFs</div>
        </div>
        <div class="emote-content">
          <div class="emote-section active" data-section="emotes">
            <div
              class="favorites-section"
              id="favoriteEmotes"
              style="display: none"
            >
              <div class="favorites-title">â­ Favoritos</div>
              <div class="favorites-grid" id="favoriteEmotesGrid"></div>
            </div>
            <div class="emote-grid" id="emotesGrid"></div>
          </div>
          <div class="emote-section" data-section="gifs">
            <div
              class="favorites-section"
              id="favoriteGifs"
              style="display: none"
            >
              <div class="favorites-title">â­ Favoritos</div>
              <div class="favorites-grid" id="favoriteGifsGrid"></div>
            </div>
            <div class="emote-grid" id="gifsGrid"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Panel de GrabaciÃ³n de Audio -->
    <div class="audio-panel" id="audioPanel">
      <div class="audio-panel-header">
        <div class="rec-indicator">
          <span class="rec-dot"></span>
          <span class="rec-text">REC</span>
        </div>
        <button class="close-audio-panel" id="closeAudioPanel">
          <img src="/images/close.svg" alt="Close" class="close-icon" />
        </button>
      </div>
      <canvas
        class="audio-visualizer"
        id="audioVisualizer"
        width="300"
        height="80"
      ></canvas>
      <div class="audio-timer" id="audioTimer">00:00</div>
      <div class="audio-controls">
        <button class="audio-btn play" id="playBtn" title="Grabar">
          <img src="/images/play.svg" alt="Play" class="audio-icon" />
        </button>
        <button class="audio-btn stop" id="stopBtn" title="Detener">
          <img src="/images/stop.svg" alt="Stop" class="audio-icon" />
        </button>
        <button class="audio-btn delete" id="deleteAudioBtn" title="Eliminar">
          <img src="/images/trash.svg" alt="Delete" class="audio-icon" />
        </button>
        <button
          class="audio-btn upload"
          id="uploadAudioBtn"
          title="Subir audio"
        >
          <img src="/images/folder.svg" alt="Upload" class="audio-icon" />
        </button>
        <button class="audio-btn send" id="sendAudioBtn" title="Enviar">
          <img src="/images/send.svg" alt="Send" class="audio-icon" />
        </button>
      </div>
    </div>

    <!-- Overlay para cerrar panel -->
    <div class="audio-panel-overlay" id="audioPanelOverlay"></div>

    <!-- Panel de Encuestas -->
    <div class="polls-panel-overlay" id="pollsPanelOverlay">
      <div class="polls-panel" id="pollsPanel">
        <div class="polls-panel-header">
          <h2>Encuestas</h2>
          <img src="/images/close.svg" alt="Close" class="close-polls-panel" />
        </div>
        <div class="polls-panel-tabs">
          <button class="polls-tab active" data-tab="active">Activas</button>
          <button class="polls-tab" data-tab="create">Crear</button>
        </div>
        <div class="polls-panel-content">
          <div class="polls-list active" data-section="active">
            <div class="empty-polls">No hay encuestas activas</div>
          </div>
          <div class="polls-create" data-section="create">
            <div class="create-poll-form">
              <input
                type="text"
                class="poll-question"
                placeholder="Pregunta de la encuesta"
                maxlength="100"
              />
              <div class="poll-options">
                <input
                  type="text"
                  class="poll-option"
                  placeholder="OpciÃ³n 1"
                  maxlength="50"
                />
                <input
                  type="text"
                  class="poll-option"
                  placeholder="OpciÃ³n 2"
                  maxlength="50"
                />
              </div>
              <button class="add-option-btn">+ AÃ±adir opciÃ³n</button>
              <button class="create-poll-btn">Crear Encuesta</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="/loading-animation.js"></script>
    <script src="/refresh-button.js"></script>
    <script type="module" src="/main.js"></script>
    <script type="module" src="/firebase.js"></script>
    <script type="module" src="/games-panel.js"></script>
    <script type="module" src="/script.js"></script>
    <script type="module" src="/level-init.js"></script>
    <script type="module" src="/emote-manager.js"></script>
    <script type="module" src="/polls.js"></script>
    <script type="module" src="/notifications.js"></script>
    <!-- Panel de Salas -->
    <div class="rooms-panel-overlay" id="roomsPanelOverlay">
      <div class="rooms-panel" id="roomsPanel">
        <div class="rooms-panel-header">
          <h2>Salas</h2>
          <img src="/images/close.svg" alt="Close" class="close-rooms-panel" />
        </div>
        <div class="rooms-panel-tabs">
          <button class="rooms-tab active" data-tab="public">PÃºblicas</button>
          <button class="rooms-tab" data-tab="private">Privadas</button>
        </div>
        <div class="rooms-panel-content">
          <div class="rooms-list active" data-section="public">
            <!-- Salas pÃºblicas se cargarÃ¡n aquÃ­ -->
          </div>
          <div class="rooms-list" data-section="private">
            <!-- Salas privadas se cargarÃ¡n aquÃ­ -->
          </div>
        </div>
      </div>
    </div>

    <!-- Panel de Usuario -->
    <div class="user-panel-overlay">
      <div class="user-panel">
        <div class="user-panel-header">
          <div class="user-panel-tabs">
            <div class="user-panel-tab active" data-tab="config">Perfil</div>
            <div class="user-panel-tab" data-tab="commands">Comandos</div>
            <div class="user-panel-tab" data-tab="rules">Reglas</div>
          </div>
          <img src="/images/close.svg" alt="Close" class="close-panel" />
        </div>
        <div class="user-panel-content">
          <div class="config-section">
            <div class="config-item" data-config="name">
              <span>Cambiar nombre</span>
              <button>Editar</button>
              <div class="config-input">
                <input type="text" placeholder="Nuevo nombre" maxlength="20" />
                <div class="input-buttons">
                  <button class="accept-btn">Aceptar</button>
                  <button class="cancel-btn">Cancelar</button>
                </div>
              </div>
            </div>
            <div class="config-item" data-config="photo">
              <span>Cambiar foto de perfil</span>
              <button>Subir</button>
              <div class="config-input">
                <input type="file" accept="image/*" class="file-input" />
                <div class="input-buttons">
                  <button class="accept-btn">Aceptar</button>
                  <button class="cancel-btn">Cancelar</button>
                </div>
              </div>
            </div>
            <div class="config-item" data-config="color">
              <span>Cambiar color</span>
              <button>Personalizar</button>
              <div class="color-picker-panel">
                <div class="color-preview">
                  <span>Vista previa:</span>
                  <span class="color-preview-text">username</span>
                </div>
                <input type="color" class="color-input" value="#ffffff" />
                <div class="input-buttons">
                  <button class="accept-btn">Aceptar</button>
                  <button class="cancel-btn">Cancelar</button>
                </div>
              </div>
            </div>
            <div class="config-item" data-config="description">
              <span>DescripciÃ³n de perfil</span>
              <button>Editar</button>
              <div class="config-input">
                <input
                  type="text"
                  placeholder="Nueva descripciÃ³n"
                  maxlength="100"
                />
                <div class="input-buttons">
                  <button class="accept-btn">Aceptar</button>
                  <button class="cancel-btn">Cancelar</button>
                </div>
              </div>
            </div>
            <div class="config-item" data-config="country">
              <span>PaÃ­s</span>
              <button>Editar</button>
              <div class="country-selector-panel">
                <select class="country-select">
                  <option value="">Selecciona tu paÃ­s</option>
                  <option value="ğŸ‡¦ğŸ‡·">ğŸ‡¦ğŸ‡· Argentina</option>
                  <option value="ğŸ‡§ğŸ‡·">ğŸ‡§ğŸ‡· Brasil</option>
                  <option value="ğŸ‡¨ğŸ‡±">ğŸ‡¨ğŸ‡± Chile</option>
                  <option value="ğŸ‡¨ğŸ‡´">ğŸ‡¨ğŸ‡´ Colombia</option>
                  <option value="ğŸ‡¨ğŸ‡·">ğŸ‡¨ğŸ‡· Costa Rica</option>
                  <option value="ğŸ‡¨ğŸ‡º">ğŸ‡¨ğŸ‡º Cuba</option>
                  <option value="ğŸ‡ªğŸ‡¨">ğŸ‡ªğŸ‡¨ Ecuador</option>
                  <option value="ğŸ‡¸ğŸ‡»">ğŸ‡¸ğŸ‡» El Salvador</option>
                  <option value="ğŸ‡ªğŸ‡¸">ğŸ‡ªğŸ‡¸ EspaÃ±a</option>
                  <option value="ğŸ‡ºğŸ‡¸">ğŸ‡ºğŸ‡¸ Estados Unidos</option>
                  <option value="ğŸ‡¬ğŸ‡¹">ğŸ‡¬ğŸ‡¹ Guatemala</option>
                  <option value="ğŸ‡­ğŸ‡³">ğŸ‡­ğŸ‡³ Honduras</option>
                  <option value="ğŸ‡²ğŸ‡½">ğŸ‡²ğŸ‡½ MÃ©xico</option>
                  <option value="ğŸ‡³ğŸ‡®">ğŸ‡³ğŸ‡® Nicaragua</option>
                  <option value="ğŸ‡µğŸ‡¦">ğŸ‡µğŸ‡¦ PanamÃ¡</option>
                  <option value="ğŸ‡µğŸ‡¾">ğŸ‡µğŸ‡¾ Paraguay</option>
                  <option value="ğŸ‡µğŸ‡ª">ğŸ‡µğŸ‡ª PerÃº</option>
                  <option value="ğŸ‡µğŸ‡·">ğŸ‡µğŸ‡· Puerto Rico</option>
                  <option value="ğŸ‡©ğŸ‡´">ğŸ‡©ğŸ‡´ RepÃºblica Dominicana</option>
                  <option value="ğŸ‡ºğŸ‡¾">ğŸ‡ºğŸ‡¾ Uruguay</option>
                  <option value="ğŸ‡»ğŸ‡ª">ğŸ‡»ğŸ‡ª Venezuela</option>
                  <option value="ğŸŒ">ğŸŒ Otro</option>
                </select>
                <div class="input-buttons">
                  <button class="accept-btn">Aceptar</button>
                  <button class="cancel-btn">Cancelar</button>
                </div>
              </div>
            </div>
            <div class="config-item" data-config="background">
              <span>Cambiar fondo</span>
              <button>Seleccionar</button>
              <div class="config-input">
                <div class="background-options">
                  <button class="bg-upload-btn">Subir imagen</button>
                  <button class="bg-remove-btn">Eliminar fondo</button>
                </div>
                <div class="input-buttons">
                  <button class="cancel-btn">Cancelar</button>
                </div>
              </div>
            </div>
            <div class="config-item" data-config="password">
              <span>Cambiar contraseÃ±a</span>
              <button>Cambiar</button>
              <div class="config-input">
                <input
                  type="password"
                  placeholder="Nueva contraseÃ±a"
                  maxlength="50"
                />
                <div class="input-buttons">
                  <button class="accept-btn">Aceptar</button>
                  <button class="cancel-btn">Cancelar</button>
                </div>
              </div>
            </div>
            <div
              class="config-item admin-only"
              data-config="grant-admin"
              style="display: none"
            >
              <span>Otorgar rol de administrador</span>
              <button>Asignar</button>
              <div class="config-input">
                <input type="text" placeholder="UID del usuario" />
                <div class="input-buttons">
                  <button class="accept-btn">Aceptar</button>
                  <button class="cancel-btn">Cancelar</button>
                </div>
              </div>
            </div>
            <div class="config-item">
              <span>Cerrar sesiÃ³n</span>
              <button>Salir</button>
            </div>
            <div class="config-item danger">
              <span>Borrar cuenta</span>
              <button>Eliminar</button>
            </div>
          </div>

          <div class="commands-section">
            <div class="commands-content">
              <h3>ğŸ“‹ Comandos Disponibles</h3>

              <div class="command-category">
                <h4>ğŸ‘¥ Todos los Usuarios</h4>
                <div class="command-item">
                  <span class="command-name">!crearprivada</span>
                  <span class="command-desc"
                    >Crear sala privada con acceso controlado</span
                  >
                </div>
                <div class="command-item">
                  <span class="command-name">!aceptar</span>
                  <span class="command-desc"
                    >Ver usuarios pendientes en tu sala privada</span
                  >
                </div>
                <div class="command-item">
                  <span class="command-name">!aceptar &lt;nÃºmero&gt;</span>
                  <span class="command-desc"
                    >Aceptar usuario en tu sala privada (solo dueÃ±o)</span
                  >
                </div>
              </div>

              <div class="command-category">
                <h4>â­ Moderadores</h4>
                <div class="command-item">
                  <span class="command-name">!crearsala &lt;nombre&gt;</span>
                  <span class="command-desc"
                    >Crear sala pÃºblica (mÃ¡x 10 caracteres)</span
                  >
                </div>
                <div class="command-item">
                  <span class="command-name">!ban</span>
                  <span class="command-desc"
                    >Ver lista de usuarios conectados</span
                  >
                </div>
                <div class="command-item">
                  <span class="command-name">!ban &lt;nÃºmero&gt; [razÃ³n]</span>
                  <span class="command-desc"
                    >Banear usuario por ID numÃ©rico</span
                  >
                </div>
                <div class="command-item">
                  <span class="command-name">!mute</span>
                  <span class="command-desc"
                    >Ver lista de usuarios conectados</span
                  >
                </div>
                <div class="command-item">
                  <span class="command-name"
                    >!mute &lt;nÃºmero&gt; [minutos]</span
                  >
                  <span class="command-desc"
                    >Mutear usuario (por defecto 5 min)</span
                  >
                </div>
                <div class="command-item">
                  <span class="command-name">!unmute</span>
                  <span class="command-desc"
                    >Ver lista de usuarios muteados</span
                  >
                </div>
                <div class="command-item">
                  <span class="command-name">!unmute &lt;nÃºmero&gt;</span>
                  <span class="command-desc"
                    >Desmutear usuario por ID numÃ©rico</span
                  >
                </div>
                <div class="command-item">
                  <span class="command-name">!anuncio &lt;mensaje&gt;</span>
                  <span class="command-desc"
                    >Enviar anuncio a todas las salas</span
                  >
                </div>
              </div>

              <div class="command-category">
                <h4>ğŸ”´ Administradores</h4>
                <div class="command-item">
                  <span class="command-name">!versalas</span>
                  <span class="command-desc"
                    >Ver panel de gestiÃ³n de salas</span
                  >
                </div>
                <div class="command-item">
                  <span class="command-name">!borrar &lt;nombre&gt;</span>
                  <span class="command-desc"
                    >Eliminar sala (temporizador 15s)</span
                  >
                </div>
                <div class="command-item">
                  <span class="command-name">!unban</span>
                  <span class="command-desc"
                    >Ver lista de usuarios baneados</span
                  >
                </div>
                <div class="command-item">
                  <span class="command-name">!unban &lt;nÃºmero&gt;</span>
                  <span class="command-desc"
                    >Desbanear usuario por ID numÃ©rico</span
                  >
                </div>
                <div class="command-item">
                  <span class="command-name">!borrarchat</span>
                  <span class="command-desc"
                    >Eliminar historial de la sala actual</span
                  >
                </div>
              </div>

              <div class="command-category">
                <h4>ğŸ”’ Salas Privadas</h4>
                <p class="command-info">
                  â€¢ Cualquier usuario puede crear salas privadas
                </p>
                <p class="command-info">
                  â€¢ Solo el dueÃ±o puede aceptar usuarios
                </p>
                <p class="command-info">
                  â€¢ Los usuarios deben solicitar acceso
                </p>
                <p class="command-info">
                  â€¢ El dueÃ±o puede eliminar su sala privada
                </p>
              </div>
            </div>
          </div>

          <div class="rules-section">
            <div class="rules-content">
              <h3>Reglas del Chat</h3>
              <p>
                Bienvenido a nuestro espacio digital. AquÃ­ las reglas son
                simples pero fundamentales:
              </p>
              <br />
              <p>1. Respeta a todos los usuarios sin excepciÃ³n</p>
              <p>2. No spam ni contenido inapropiado</p>
              <p>3. MantÃ©n las conversaciones relevantes al tema</p>
              <p>4. No compartir informaciÃ³n personal</p>
              <p>5. Reporta cualquier comportamiento inadecuado</p>
              <br />
              <p>
                El incumplimiento de estas reglas puede resultar en suspensiÃ³n
                temporal o permanente de tu cuenta.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
